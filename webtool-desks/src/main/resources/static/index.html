<!doctype html>
<html>
<head>
    <title>webapp: desks</title>
    <script src="/angular/angular.js"></script>
    <script src="/ngstorage/ngStorage.js"></script>
    <script src="/ng-dialog/js/ngDialog.js"></script>
    <script src="FileSaver.js"></script><!-- TODO: more sophisticated way -->
    <script src="app.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/main.css" />
    <link rel="stylesheet" type="text/css" href="/ng-dialog/css/ngDialog.css" />
    <link rel="stylesheet" type="text/css" href="/ng-dialog/css/ngDialog-theme-default.css" />
</head>
<body ng-app="desksApp">
<div class="app-container" ng-controller="DesksController as vm">
    <div class="app-title">TechDraw: Desks</div>
    <div class="toolbar">
        <button type="button" ng-click="vm.open()">Open</button>
        <button type="button" ng-click="vm.save()">Save</button>
        <div class="flex-space"></div>
        <button type="button" ng-click="vm.newDeskPartGroup()">New group</button>
        <div class="flex-space"></div>
        <button class="secondary" type="button" ng-click="vm.generateSVG()">Generate SVG</button>
        <button class="primary" type="button" ng-click="vm.generatePDF()">Generate PDF</button>
    </div>
    <div class="styled-g" style="flex: 1 1 0">
        <div class="properties_pane">
            <form class="styled-form" ng-submit="false">
                <div class="desk-group" ng-repeat="group in vm.model.groups">
                    <div class="desk-group-title">Desks ({{group.material.decor}}, {{group.material.width}}mm)</div>
                    <div class="content-box">
                        <div class="desk-group-material">
                            <span>
                                <label for="decor_{{$index}}">Decor</label>
                                <input id="decor_{{$index}}" ng-model="group.material.decor" required />
                            </span>
                            <span>
                                <label for="width_{{$index}}">Width</label>
                                <input id="width_{{$index}}" type="number" placeholder="width" min="0" max="1000" step="1"  ng-model="group.material.width" required />
                            </span>
                        </div>
                        <div>
                            <table>
                                <thead>
                                    <tr>
                                        <th>Key</th>
                                        <th>a</th>
                                        <th>b</th>
                                        <th>Edges</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-repeat="desk in group.desks">
                                        <td><input type="text" placeholder="key" ng-model="desk.key" /></td>
                                        <td><input type="number" placeholder="a" min="1" max="10000" step="1" ng-model="desk.a" required /></td>
                                        <td><input type="number" placeholder="b" min="1" max="10000" step="1" ng-model="desk.b" required /></td>
                                        <td>
                                            <input type="checkbox" ng-model="desk.edges[0]" />
                                            <input type="checkbox" ng-model="desk.edges[1]" />
                                            <input type="checkbox" ng-model="desk.edges[2]" />
                                            <input type="checkbox" ng-model="desk.edges[3]" />
                                        </td>
                                        <td>
                                            <button class="remove" type="button" ng-click="vm.removeDesk(group, $index)">X</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <div class="buttons">
                                <button type="button" ng-click="vm.addDesk(group)">Add desk</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="extra-options">
                    <span>
                        <label for="title">Title</label>
                        <input id="title" ng-model="vm.model.documentTitle" />
                    </span>
                    <span>
                        <label for="header">Header</label>
                        <input id="header" ng-model="vm.model.pageHeader" />
                    </span>
                    <span>
                        <label for="footer">Footer</label>
                        <input id="footer" ng-model="vm.model.pageFooter" />
                    </span>
                </div>
                <div class="extra-options">
                    <span>
                        <label for="marginTop">Margin top</label>
                        <input id="marginTop" ng-model="vm.model.pageStyle.marginTop" />
                    </span>
                    <span>
                        <label for="marginBottom">Margin bottom</label>
                        <input id="marginBottom" ng-model="vm.model.pageStyle.marginBottom" />
                    </span>
                    <span>
                        <label for="marginLeft">Margin left</label>
                        <input id="marginLeft" ng-model="vm.model.pageStyle.marginLeft" />
                    </span>
                    <span>
                        <label for="marginRight">Margin right</label>
                        <input id="marginRight" ng-model="vm.model.pageStyle.marginRight" />
                    </span>
                </div>
            </form>
        </div>
        <div style="font-size: 0.67em" class="preview_pane">
            <div class=" content-box">
                <div class="overlay top right">
                    <input type="checkbox" ng-model="vm.formattedPreview" id="formattedPreview"/>
                    <label for="formattedPreview">Formatted preview</label>
                </div>
                <pre ng-if="!vm.formattedPreview">{{vm.model}}</pre>
                <pre ng-if="vm.formattedPreview">{{vm.model | json}}</pre>
            </div>
        </div>
    </div>
</div>
</body>
</html>